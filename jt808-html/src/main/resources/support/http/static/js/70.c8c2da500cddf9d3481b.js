webpackJsonp([70],{"+D61":function(t,e){},zdzH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("u2KI"),l=a.n(i),s=(a("TFOu"),a("ow4a")),o=a("d2xA"),n=(a("Zwc7"),a("88jF"),a("4+z/")),r=a.n(n),c=(a("iTWp"),a("Pm2p"),a("Cf2s"),a("LHmc"),{name:"HistoryDialog",data:function(){return{dialogVisible1:!1,carid:null,carno:null,islbbclick:!0,lbbclick:!0,isShowInfoWindow1:!0,data:[],center:{lng:116.396621,lat:39.916385},zoom:13,value1:0,form:{check1:!0,check2:!0},value:new Date,list:[]}},methods:{openDialog:function(t,e){var a=this;this.carid=t,this.carno=e,this.dialogVisible1=!0,this.value=new Date;var i=new Date,l=i.format("yyyyMMddHHmmss");i.setMonth(i.getMonth()-3);var o=i.format("yyyyMMddHHmmss");this.callApi({apicode:1154,tid:this.carid,stime:o,etime:l},function(t){a.list=t.data}),this.map||(this.map=this.$refs.lingxMap2.getMap()),this.layer||(this.layer=new s.k("vector").addTo(this.map))},loadData:function(){var t=this;this.index=0,this.currentValue=0,this.lc=0,this.isShowInfoBottom=!1,this.isRun=!1,this.isFast=!1,this.showOverlay=!0,this.layer.clear(),Toast("正在加载数据..."),this.callApi({apicode:1105,car_id:this.carid,timeStop:this.radio2,static:!0,stime:this.stime,etime:this.etime,alarm:!0},function(e){if(t.showOverlay=!1,0==e.data.length&&Toast("该设备在此时间段内无数据！"),e.data.length>0){t.isShowInfoBottom=!0,Toast("成功加载"+e.data.length+"条数据！"),t.data=l()(e.data),t.car=t.data[0],t.listStop=e.stops,t.listAlarm=e.alarms;for(var a=[],i=0;i<t.data.length;i++)t.data[i].lng_offset&&(a.push([t.data[i].lng_offset-0,t.data[i].lat_offset-0]),t.createMarker(t.data[i],i));t.geometry=new s.f(a,{symbol:symbol}),t.layer.addGeometry(t.geometry),t.map.fitExtent(t.geometry.getExtent(),0),t.marker1=new s.h([t.data[0].lng_offset-0,t.data[0].lat_offset-0],{properties:{name:t.carno},symbol:[{markerFile:r.a,markerWidth:40,markerHeight:40,markerDx:0,markerDy:20,markerOpacity:1,markerRotation:t.getRotation(t.car.direction)},{textName:"{name}",textSize:14,textDy:-24,textFill:"#004e98",textWeight:"bold"}]}).addTo(t.layer);var o=e.data;for(i=0;i<o.length;i++)i+1<o.length&&(t.lc=t.lc+t.distance(o[i].lat,o[i].lng,o[i+1].lat,o[i+1].lng)/1e3)}})},distance:function(t,e,a,i){var l=Math.abs(102834.74258026089*(e-i)),s=Math.abs(111712.69150641056*(t-a));return Math.sqrt(s*s+l*l)},getDtlc:function(t){for(var e=0,a=t.format("yyyyMMdd"),i=0;i<this.list.length;i++)if(a==this.list[i].date){e=this.list[i].mileage;break}return e},changeSlider:function(){},queryHistory:function(){},downloadExcel:function(){},startPlay:function(){},stopPlay:function(){},getCarno:function(){},formatDatetime:function(){},formatTxxh:function(){},formatDwxh:function(){}},mounted:function(){},components:{LingxMap:o.a}}),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticStyle:{margin:"0px"},attrs:{title:t.carno+" - 历史轨迹",visible:t.dialogVisible1,fullscreen:!0,"show-close":"","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible1=e}}},[a("el-container",{staticStyle:{height:"100%"}},[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.islbbclick,expression:"islbbclick"}],staticStyle:{"background-color":"#fff","border-right":"#c1c5cd 1px solid",overflow:"hidden",display:"flex","flex-direction":"column"},attrs:{width:"380px"}},[a("div",{staticClass:"noselect",staticStyle:{height:"380px",overflow:"hidden"}},[a("el-calendar",{scopedSlots:t._u([{key:"dateCell",fn:function(e){var i=e.date,l=e.data;return[a("div",{class:l.isSelected?"is-selected":"",staticStyle:{width:"100%",height:"100%","text-align":"center"}},[a("div",{staticStyle:{"padding-top":"6px"}},[t._v(t._s(i.getDate()))]),t._v(" "),a("div",{staticStyle:{"font-size":"9px","line-height":"10px"}},[t._v(t._s(t.getDtlc(i))+" km")])])]}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),a("div",{staticStyle:{flex:"1","flex-grow":"1","border-top":"#c1c5cd 1px solid","background-color":"#ced9e7"}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"行程"}},[t._v("用户管理")]),t._v(" "),a("el-tab-pane",{attrs:{label:"停车"}},[t._v("配置管理")]),t._v(" "),a("el-tab-pane",{attrs:{label:"告警"}},[t._v("角色管理")])],1)],1)]),t._v(" "),a("el-container",{staticStyle:{width:"100%",height:"100%",margin:"0px",padding:"0px"}},[a("el-main",{staticStyle:{margin:"0px",padding:"0px"}},[a("LingxMap",{ref:"lingxMap2",attrs:{mapid:"historyMap",zoom:t.zoom,center:t.center,isLeftBottmButton1:!1},on:{isShowInfoWindow:t.isShowInfoWindow1,lbbclick:t.lbbclick}})],1),t._v(" "),a("el-footer",{directives:[{name:"show",rawName:"v-show",value:t.islbbclick,expression:"islbbclick"}],staticStyle:{"background-color":"#fff",height:"300px",padding:"0px"}},[a("div",{staticClass:"block",staticStyle:{display:"flex"}},[a("div",{staticStyle:{width:"40px",padding:"6px 0px 0px 6px"}},[a("i",{staticClass:"el-icon-video-play",staticStyle:{"font-size":"24px",cursor:"pointer"},attrs:{title:"播放/暂停"}})]),t._v(" "),a("div",{staticStyle:{flex:"1","flex-grow":"1"}},[a("el-slider",{attrs:{disabled:0==t.data.length,"input-size":"mini","show-tooltip":!1},on:{change:t.changeSlider},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1),t._v(" "),a("div",{staticStyle:{width:"60px","text-align":"center",padding:"6px 0px 0px 6px"}},[a("i",{staticClass:"el-icon-caret-left",staticStyle:{"font-size":"24px",cursor:"pointer"},attrs:{title:"后退"}}),t._v(" "),a("i",{staticClass:"el-icon-caret-right",staticStyle:{"font-size":"24px",cursor:"pointer"},attrs:{title:"前进"}})])]),t._v(" "),a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"里程图表"}},[t._v("用户管理")]),t._v(" "),a("el-tab-pane",{attrs:{label:"时速图表"}},[t._v("配置管理")]),t._v(" "),a("el-tab-pane",{attrs:{label:"数据流水"}},[t._v("角色管理")]),t._v(" "),a("el-tab-pane",{attrs:{label:"其他操作"}},[t._v("定时任务补偿")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(c,d,!1,function(t){a("+D61")},"data-v-7c6b76bf",null);e.default=h.exports}});