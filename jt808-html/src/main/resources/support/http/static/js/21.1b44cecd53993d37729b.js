webpackJsonp([21],{TJKj:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"ChargeStatistics",data:function(){return{onlines:[],value2:"",value3:"",value4:"",excelAble:!1,tids:[],gids:[],fields:[{name:"终端ID",code:"tid"},{name:"车牌号码",code:"carno"},{name:"隶属车队",code:"group"}],pickerOptions:{disabledDate:function(e){return(new Date).format("yyyyMMdd")<e.format("yyyyMMdd")},shortcuts:[{text:"最近一天",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-864e5),e.$emit("pick",[i,t])}},{text:"最近三天",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-2592e5),e.$emit("pick",[i,t])}},{text:"最近七天",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-6048e5),e.$emit("pick",[i,t])}},{text:"最近十五天",onClick:function(e){var t=new Date,i=new Date;i.setTime(i.getTime()-1296e6),e.$emit("pick",[i,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,i=new Date;i.setMonth(i.getMonth()-1),e.$emit("pick",[i,t])}}]},tableData:[]}},methods:{formatTime6:function(e,t,i){return parseFloat(i/60/60).toFixed(1)},getCarno:function(e,t,i){return i[0].carno},excel:function(){window.location.href=this.excelURL+"?ecode=tgps_charge_record&userid="+this.$store.getters.getUser.id+"&token="+this.$store.getters.getUser.token},day7:function(){var e=new Date,t=new Date;t.setTime(t.getTime()-6048e5),this.value3=t.getTime(),this.value4=e.getTime()},day15:function(){var e=new Date,t=new Date;t.setTime(t.getTime()-1296e6),this.value3=t.getTime(),this.value4=e.getTime()},day30:function(){var e=new Date,t=new Date;t.setMonth(t.getMonth()-1),this.value3=t.getTime(),this.value4=e.getTime()},initCharts:function(){var e=this.$echarts.init(this.$refs.chart),t=this.onlines.map(function(e){return e.date}),i=this.onlines.map(function(e){return e.count});e.setOption({title:{text:"车辆充电时间统计图",textStyle:{fontSize:28}},grid:{top:"90px",left:"100px",right:"100px",containLabel:!1},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:[{name:"时间",type:"category",data:t,axisTick:{alignWithLabel:!0},nameTextStyle:{color:"#3388ee",fontSize:16},axisLabel:{color:"#3388ee",fontSize:14,margin:14}}],yAxis:{name:"充电时间（小时）",nameTextStyle:{color:"#3388ee",fontSize:16},axisLabel:{color:"#3388ee",fontSize:14,borderColor:"#000"}},series:[{name:"充电时间（小时）：",type:"bar",data:i,label:{normal:{show:!0,position:"top",textStyle:{color:"#000",fontSize:14}}}}]})},searchGrid:function(){if(0!=this.tids.length||0!=this.gids.length)if(this.value3&&this.value4){var e=new Date(this.value3),t=new Date(this.value4),i=this;this.callApi({apicode:1137,tids:this.tids,gids:this.gids,stime:this.value3,etime:this.value4},function(e){1==e.code?(i.excelAble=!0,i.onlines=e.data,i.initCharts()):i.lgxInfo2(e.message)});for(var a="",n=0;n<this.tids.length;n++)a=a+this.tids[n]+",";a=(a=a.substring(0,a.length-1)).replace(",","','"),this.callApi({apicode:8002,e:"tgps_charge_record",m:"grid",cx_tid:a,limit:1e4,page:1,orderField:"id",orderType:"desc",cx_stime:e.format("yyyyMMdd"),cx_etime:t.format("yyyyMMdd")},function(e){i.tableData=e.rows})}else this.lgxInfo2("操作失败，日期不可为空!");else this.lgxInfo2("操作失败，请选择要统计的车辆!")},lingxcheckchange:function(e,t,i){if(t)(e.id+"").indexOf("_")>0?this.tids.push(e.value+""):this.gids.push(e.value);else{for(var a=-1,n=0;n<this.tids.length;n++)if(e.value==this.tids[n]){a=n;break}a>=0&&this.tids.splice(a,1),a=-1;for(n=0;n<this.gids.length;n++)if(e.value==this.gids[n]){a=n;break}a>=0&&this.gids.splice(a,1)}},lingxnodeclick:function(e){}},components:{LingxCarTree:i("Zwc7").a}};var n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[i("el-container",{staticStyle:{height:"100%"}},[i("el-aside",{staticStyle:{"background-color":"#fff","border-right":"#c1c5cd 1px solid"},attrs:{width:"260px"}},[i("LingxCarTree",{ref:"lingxCarTree",on:{lingxcheckchange:e.lingxcheckchange,lingxnodeclick:e.lingxnodeclick}})],1),e._v(" "),i("el-container",{staticStyle:{width:"100%",height:"100%",margin:"0px",padding:"0px"}},[i("el-header",{staticStyle:{padding:"0px"},attrs:{height:"42"}},[i("div",{staticStyle:{margin:"5px"}},[i("span",[i("el-date-picker",{staticStyle:{width:"150px"},attrs:{"value-format":"timestamp",type:"date",size:"small",placeholder:"起始日期"},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}}),e._v(" "),i("el-date-picker",{staticStyle:{width:"150px"},attrs:{"value-format":"timestamp",type:"date",size:"small",placeholder:"截止日期"},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}})],1),e._v(" "),i("el-button",{staticStyle:{padding:"10px 15px 8px 15px"},attrs:{size:"small",type:"primary",plain:"",icon:"el-icon-search"},on:{click:e.searchGrid}},[e._v("查询")]),e._v(" "),i("el-button",{staticStyle:{padding:"10px 15px 8px 15px"},attrs:{size:"small",plain:""},on:{click:e.day7}},[e._v("最近7天")]),e._v(" "),i("el-button",{staticStyle:{padding:"10px 15px 8px 15px"},attrs:{size:"small",plain:""},on:{click:e.day15}},[e._v("最近15天")]),e._v(" "),i("el-button",{staticStyle:{padding:"10px 15px 8px 15px"},attrs:{size:"small",plain:""},on:{click:e.day30}},[e._v("最近1个月")]),e._v(" "),i("el-button",{staticStyle:{padding:"10px 15px 8px 15px"},attrs:{disabled:0==e.tableData.length,size:"small",plain:"",type:"success",icon:"el-icon-download"},on:{click:e.excel}},[e._v("导出")])],1)]),e._v(" "),i("el-main",{staticStyle:{margin:"0px",padding:"0px"}},[i("div",{ref:"chart",staticClass:"echart",staticStyle:{width:"100%",height:"500px"}}),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":"",size:"mini"}},[i("el-table-column",{attrs:{label:"",width:"42px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                   "+e._s(t.$index+1)+"\n               ")]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"tid",label:"车牌号码",width:"160",formatter:e.getCarno}}),e._v(" "),i("el-table-column",{attrs:{prop:"stime",label:"开始时间",width:"180"}}),e._v(" "),i("el-table-column",{attrs:{prop:"etime",label:"结束时间",width:"180"}}),e._v(" "),i("el-table-column",{attrs:{prop:"time",label:"充电时间(小时)",width:"180"}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var l=i("VU/8")(a,n,!1,function(e){i("XZcL")},null,null);t.default=l.exports},XZcL:function(e,t){}});